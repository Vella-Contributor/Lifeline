
<!-- AIzaSyCiOnT1WNK6z5HUU6I2vqIEdswiOjkiRj4
-->

<html>

<head>

<script src="jquery.min.js"> </script>

<link rel="stylesheet" href="mate_icon.css" >

<script type="text/javascript" src="materialize.js"> </script>

<link rel="stylesheet" href="materialize.css">

<link rel="stylesheet" href="animate.css">

<link rel="stylesheet" href="main.css">

<script src="main.js"> </script>

<script src="server_conncetion_ajax.js"></script>

</head>



<body>


	<ul id="slide-out" class="side-nav">
		
    <li><div class="userView">
      <div class="background">
        <img src="images/office.jpg">
      </div>
      <a href="#!user"><img class="circle" src="images/yuna.jpg"></a>
      <a href="#!name"><span class="white-text name">John Doe</span></a>
      <a href="#!email"><span class="white-text email">jdandturk@gmail.com</span></a>
    </div></li>
    <li><a href="#!"><i class="material-icons">cloud</i>First Link With Icon</a></li>
    <li><a href="#!">Second Link</a></li>
    <li><div class="divider"></div></li>
    <li><a class="subheader">Subheader</a></li>
    <li><a class="waves-effect" href="#!">Third Link With Waves</a></li>
  </ul>
  <a href="#" data-activates="slide-out" class="button-collapse"><i class="material-icons">menu</i></a>
    

<div id="main_frame">


	
	
	<div id="main_screen_1">

			 <nav class="nav-extended">
			    <div class="nav-wrapper red darken-2">

				      <a href="#!" class="brand-logo center"><i class="large material-icons">healing</i>LifeLine </a>
				      <ul class="left">
				        <li><a href="#"><i class="large material-icons">menu</i></a></li>
				      </ul>
				      <ul class="right">
				      	<li><a href="#"><i class="large material-icons">notifications</i></a></li>
				        <li><a href="#"><i class="large material-icons">supervisor_account</i></a></li>
		     	      </ul>
			    
			    	<ul class="tabs tabs-transparent">

						<li class="tab center-text"><a class="active waves-effect waves-yellow" href="#test1"><i class="large material-icons">my_location</i></a></li> 			

				    </ul>

			    </div>
		    </nav>

		   
			        <div id="test1">
				          <div id="map"> </div>
						 <div class="col s12 center" id="find_doc_buttons">
				    	   <a class="waves-effect waves-light btn" id="send_location_button_on" onclick="update_everything()">Find Doctors</a>		
		      		     </div> 
					</div>
    </div>

    

    <div id="screen2">
    
				    <nav class="nav-extended">

					    <div class="nav-wrapper red darken-2">
						      <a href="#!" class="brand-logo center"><i class="large material-icons">healing</i>LifeLine </a>
						      <ul class="left">
						        <li><a href="#"><i class="large material-icons">arrow_back</i></a></li>
						      </ul>
						      <ul class="right">
						      	<li><a href="#"><i class="large material-icons">notifications</i></a></li>
						        <li><a href="#"><i class="large material-icons">supervisor_account</i></a></li>
				     	      </ul>
					    
					    	<ul class="tabs tabs-transparent">

								<li class="tab center-text"><a class="active waves-effect waves-yellow" href="#car"><i class=" material-icons">directions_car</i></a></li> 

																		

						    </ul>

				        </div>
		            </nav>

		            <div id="car">

			          <div class="row its_subchildren">

					    <div class="col s12 m6 main_row_to_copy">	    
				          <div class="card blue-grey darken-1">
				            <div class="card-content white-text">
				              <span class="card-title">Dr Rohan Chougule</span>
				              <div class="row having_content">
				              	<br>
					              <div class="col s2">
					 				<i class="material-icons">subdirectory_arrow_right</i>	
					              </div>

					              <div class="col s10 surgery_thing">
					              Head Specialist
					              </div>						             

				              </div>

				               <div class="row review_system">              
					              <div class="col s1">
					 				<i class="material-icons">rate_review</i>	
					              </div>

					              <div class="col s2 offset-s1">
					                  	7/10
					              </div>

					               <div class="col s8 " style="padding-right: 0;">
					                 <a class="btn-floating btn waves-effect waves-light teal right" id="send_location_button_on"><i class="material-icons">directions</i></a>

				              </div>
					            
				              </div>

				              <div class="col s12 time_to_travel" style="padding-left: 0px;">
				             

				 
				             		<div class="col s6" style="padding-left: 0px;">
				             		<div class="col s6"><i class="material-icons">room</i>	 </div>
				             		<p id="distancei">19.2 miles</p> 
				             		</div>

					               <div class="col s6">
					               <div class="col s6"><i class="material-icons">timer</i>	 </div>

					               <p id="timeii"> 22 min far </p>  
					               </div>

				          	  </div>

				          	  <br>
				            </div>
				           
				          </div>
				        </div>
					</div>



		        
					
    </div>
</div>

</body>

<script>




	var location_of_all_doctor_for_marker=[];
	var location_of_all_doctor_for_marker_delete=[];

	var user_location= {lat:  18.606875, lng: 73.875177};

	var getting_time_data_from_google_map=[];
	var look_which_points_are_valuated=[];


      var map;
      function initMap() {

        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat:  18.606875, lng: 73.875177},
          zoom: 15
        });
    
           var marker = new google.maps.Marker({
             position: user_location,
             map: map,
             animation: google.maps.Animation.DROP
             });

      }

      		function now_update_everything(){



      			document.getElementById("screen2").style.display="block";
      			document.getElementById("main_screen_1").style.display="none";


      			console.log(updated_location_array);


     	var distance_matrix=[];		

  		var lat_lng=[];

  		  for(var i=0;i<updated_location_array.length;i++)
  		{
  		   var orgins = new google.maps.LatLng(updated_location_array[i].lat,updated_location_array[i].lng);

  			lat_lng.push(orgins);
  		}

  			for(var i=0;i<1;i++)
  			{
  				var origin1 = new google.maps.LatLng(18.606875,73.875177);

				var destinationA = 'Stockholm, Sweden';
				var destinationB = new google.maps.LatLng(50.087692, 14.421150);

				var service = new google.maps.DistanceMatrixService();
				service.getDistanceMatrix(
				  {
				    origins: [origin1],
				    destinations: lat_lng,
				    travelMode: 'DRIVING',
				    avoidHighways:true,
				    avoidTolls: true,
				     drivingOptions: {
					       departureTime: new Date(Date.now()),					      
			 			   trafficModel: 'bestguess'
					    }

				  }, callback);


  		

				function callback(response, status) {
				   
				    if(status=="OK") {

				    	distance_matrix=response;
				       
				        console.log( 
				        	response
									);

				    } else {
				        alert("Error: " + status);
				    }

		          }

		    }

		    setTimeout(function(){

		    	console.log(distance_matrix.rows[0].elements.length);


		    var temp;
		    var temp2;
		    var temp3;

		    for(var i=0;i<distance_matrix.rows[0].elements.length;i++)
		    {
		    	for(var j=0;j<distance_matrix.rows[0].elements.length-i-1;j++)
		    	{
		    			if(distance_matrix.rows[0].elements[j].duration_in_traffic.value>distance_matrix.rows[0].elements[j+1].duration_in_traffic.value)
		    			{
		    			  temp=distance_matrix.rows[0].elements[j+1];
		    			  distance_matrix.rows[0].elements[j+1]=distance_matrix.rows[0].elements[j];
						  distance_matrix.rows[0].elements[j]=temp;

						  temp2=distance_matrix.destinationAddresses[j+1];
						  distance_matrix.destinationAddresses[j+1]=distance_matrix.destinationAddresses[j];
						  distance_matrix.destinationAddresses[j]=temp2;

						  temp3=updated_location_array[j+1];
						  updated_location_array[j+1]=updated_location_array[j];
						  updated_location_array[j]=temp3;
		    			}
		    	}
		    }

		    console.log(distance_matrix);
		    console.log(updated_location_array);

		    },4000);


		    setTimeout(function(){

		    	 for(var i=1;i<updated_location_array.length;i++)
      			{
      				 console.log("hi");
      				 $(".its_subchildren").append('<div class="col s12 m6 main_row_to_copy"> <div class="card blue-grey darken-1"> <div class="card-content white-text"> <span class="card-title">Dr Rohan Chougule</span> <div class="row having_content"> <br> <div class="col s2"> <i class="material-icons">subdirectory_arrow_right</i> </div> <div class="col s10 surgery_thing"> Head Specialist </div> </div> <div class="row review_system"> <div class="col s1"> <i class="material-icons">rate_review</i> </div> <div class="col s2 offset-s1"> 7/10 </div> <div class="col s8 " style="padding-right: 0;"> <a class="btn-floating btn waves-effect waves-light teal right" id="send_location_button_on"><i class="material-icons">directions</i></a> </div> </div> <div class="col s12 time_to_travel" style="padding-left: 0px;"> <div class="col s6" style="padding-left: 0px;"> <div class="col s6"><i class="material-icons">room</i> </div> <p id="distancei">19.2 miles</p> </div> <div class="col s6"> <div class="col s6"><i class="material-icons">timer</i> </div> <p id="timeii"> 22 min far </p> </div> </div> <br> </div> </div> </div>');     					
      			}


      		for(var i=0;i<updated_location_array.length;i++)
      		{
	      		 $(".its_subchildren").children().eq(i).children().children().find("span").text(updated_location_array[i].name);

	      		 $(".its_subchildren").children().eq(i).children().eq(0).children().eq(0).find(".time_to_travel").children().eq(1).find("#timeii").text(distance_matrix.rows[0].elements[i].duration_in_traffic.text);
 				 
 				 $(".its_subchildren").children().eq(i).children().eq(0).children().eq(0).find(".review_system").children().eq(1).text(updated_location_array[i].rating);

	      		 $(".its_subchildren").children().eq(i).children().eq(0).children().eq(0).
				find(".having_content").find(".surgery_thing").text(updated_location_array[i].speci);

				$(".its_subchildren").children().eq(i).children().eq(0).children().eq(0).find(".time_to_travel").children().eq(0).find("#distancei").text(distance_matrix.rows[0].elements[i].distance.text);


  			}

		    },5000);
		    
		   

	  		/*	var origin = new google.maps.LatLng( 18.606875,  73.875177),*/
				/*destination = "Stockholm, Sweden",
			    service = new google.maps.DistanceMatrixService();

				service.getDistanceMatrix(
				    {
				        origins: [origin],
				        destinations: [destination],
				        travelMode: google.maps.TravelMode.DRIVING,
				        avoidHighways: false,
				        avoidTolls: false
				    }, 
				    callback
				);

				function callback(response, status) {
				    

				    if(status=="OK")
				    {
				       console.log(response);				      

				    }
				    else
				    {
				        alert("Error: " + status);
				    }
				}    */			


  			}



      		

    			

		 			/*for(var i=0;i<location_of_all_doctor_for_marker.length;i++)
		 			{		 				 
		 				   location_of_all_doctor_for_marker_delete[i].setMap(null);
		 			}

		 			location_of_all_doctor_for_marker=[];  // clearing both the arrays
		 			location_of_all_doctor_for_marker_delete=[];

		 			
					for(var i=0;i<updated_location_array.length;i++)
					{
				        var local={lat:updated_location_array[i].lat,lng:updated_location_array[i].lng};

				        location_of_all_doctor_for_marker.push(local);
					}

  		var origin = {lat:  18.606875, lng: 73.875177}; // using google.maps.LatLng class
		var destination = location_of_all_doctor_for_marker; // using string

		console.log(destination);

		var directionsService = new google.maps.DirectionsService();


		for(var u=0;u<destination.length;u++)
		{
			var actual_destination=destination[u];
			var travelMode="DRIVING";

			var request = {
			    origin: origin, // LatLng|string
			    destination: actual_destination, // LatLng|string
			    travelMode: travelMode,
			    drivingOptions: {
			       departureTime: new Date(Date.now()),
			         // for the time N milliseconds from now.
	 			   trafficModel: 'bestguess'
			    }
			};




			directionsService.route( request, function( response, status ) 
			{

				setTimeout(function(){

				 if ( status === 'OK' ) {

			         var point = response.routes[ 0 ].legs[ 0 ];

			         getting_time_data_from_google_map.push(point);

			         console.log(actual_destination);
			        
			       /* console.log(point);*/
			   /* }*/
			  /*  else
			    {			    

			    }



				},4000);
			   

			});


					for(var i=0;i<location_of_all_doctor_for_marker.length;i++)
				        {
				        	/* console.log("hello");*/

				            /* var marker = new google.maps.Marker({
				             position: location_of_all_doctor_for_marker[i],
				             map: map
				             });

				             location_of_all_doctor_for_marker_delete.push(marker);				             

				        }					

		    }*/



		  /*  setTimeout(function(){

		    	console.log(getting_time_data_from_google_map);


		    for(var i=0;i<getting_time_data_from_google_map.length;i++)
		    {
		    	console.log('he');
		    }

		    },4000);

		    setTimeout(function(){

	


		    },4000);
*/
		   
		

	  $(".button-collapse").sideNav();


    </script>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCiOnT1WNK6z5HUU6I2vqIEdswiOjkiRj4&callback=initMap"
    async defer>
    </script>





</html>